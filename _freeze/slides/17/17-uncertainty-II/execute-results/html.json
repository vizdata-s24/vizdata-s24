{
  "hash": "32573da2716f84a1b62b7e71d02262e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Visualizing uncertainty II\nsubtitle: Lecture 17\ntitle-slide-attributes:\n  data-background-image: ../vizdata-bg.png\n  data-background-size: stretch\n  data-slide-number: none\nformat: revealjs\n---\n\n\n\n# Warm up\n\n## Setup {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|7-8\"}\n# load packages\nlibrary(openintro)\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(ggdist)\n\n# set theme for ggplot2\nggplot2::theme_set(ggplot2::theme_bw(base_size = 16))\n\n# set figure parameters for knitr\nknitr::opts_chunk$set(\n  fig.width = 7, # 7\" width\n  fig.asp = 0.618, # the golden ratio\n  fig.retina = 3, # dpi multiplier for displaying HTML output on retina\n  fig.align = \"center\", # center align figures\n  dpi = 300 # higher dpi, sharper image\n)\n```\n:::\n\n\n\n# Visualizing uncertainty of model estimates\n\n## Data: House prices in Duke Forest {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nopenintro::duke_forest\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 98 × 13\n   address      price   bed  bath  area type  year_built heating cooling parking\n   <chr>        <dbl> <dbl> <dbl> <dbl> <chr>      <dbl> <chr>   <fct>   <chr>  \n 1 1 Learned … 1.52e6     3     4  6040 Sing…       1972 Other,… central 0 spac…\n 2 1616 Pinec… 1.03e6     5     4  4475 Sing…       1969 Forced… central Carpor…\n 3 2418 Wrigh… 4.20e5     2     3  1745 Sing…       1959 Forced… central Garage…\n 4 2527 Sevie… 6.80e5     4     3  2091 Sing…       1961 Heat p… central Carpor…\n 5 2218 Myers… 4.29e5     4     3  1772 Sing…       2020 Forced… central 0 spac…\n 6 2619 Vesso… 4.56e5     3     3  1950 Sing…       2014 Forced… central Off-st…\n 7 1803 Woodb… 1.27e6     5     5  3909 Sing…       1968 Forced… central Carpor…\n 8 19 Learned… 5.57e5     4     3  2841 Sing…       1973 Heat p… central Carpor…\n 9 2827 Mcdow… 6.97e5     4     5  3924 Sing…       1972 Other,… central Covered\n10 2709 Mcdow… 6.5 e5     3     2  2173 Sing…       1964 Forced… other   0 spac…\n# ℹ 88 more rows\n# ℹ 3 more variables: lot <dbl>, hoa <chr>, url <chr>\n```\n\n\n:::\n:::\n\n\n\n## Price vs. area\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(duke_forest, aes(x = area, y = price)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](17-uncertainty-II_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=2100}\n:::\n:::\n\n\n\n## Price vs. bedrooms\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(duke_forest, aes(x = bed, y = price)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](17-uncertainty-II_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=2100}\n:::\n:::\n\n\n\n## Price vs. area + bedrooms\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(duke_forest, aes(x = area, y = price)) +\n  geom_point() +\n  facet_wrap(~bed)\n```\n\n::: {.cell-output-display}\n![](17-uncertainty-II_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=2100}\n:::\n:::\n\n\n\n## Data prep\n\n-   Remove 6 bedroom houeses\n-   Make `bed` a factor variable\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nduke_forest <- duke_forest |>\n  filter(bed != 6) |>\n  mutate(bed = as.factor(bed))\n\nduke_forest |>\n  select(price, area, bed)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 97 × 3\n     price  area bed  \n     <dbl> <dbl> <fct>\n 1 1520000  6040 3    \n 2 1030000  4475 5    \n 3  420000  1745 2    \n 4  680000  2091 4    \n 5  428500  1772 4    \n 6  456000  1950 3    \n 7 1270000  3909 5    \n 8  557450  2841 4    \n 9  697500  3924 4    \n10  650000  2173 3    \n# ℹ 87 more rows\n```\n\n\n:::\n:::\n\n\n\n## Fit a model\n\n::: task\nInterpret the slopes and the intercept.\nThen, describe what `std.error` in the output means.\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprice_fit <- lm(price ~ area + bed, data = duke_forest)\ntidy(price_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 5\n  term        estimate std.error statistic       p.value\n  <chr>          <dbl>     <dbl>     <dbl>         <dbl>\n1 (Intercept)   84433.   94534.      0.893 0.374        \n2 area            149.      23.0     6.47  0.00000000459\n3 bed3          71305.   91393.      0.780 0.437        \n4 bed4          49319.   92366.      0.534 0.595        \n5 bed5          95113.  107503.      0.885 0.379        \n```\n\n\n:::\n:::\n\n\n\n## Let's bootstrap!\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nn_rep <- 500\n\nset.seed(25)\n\nduke_forest_bootstraps <- map_dfr(\n  seq_len(n_rep),\n  function(i) {\n    duke_forest |>\n      slice_sample(prop = 1, by = bed, replace = TRUE) |>\n      mutate(resample = i, .before = address)\n  }\n)\n```\n:::\n\n\n\n## Bootstrap samples {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nduke_forest_bootstraps\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 48,500 × 14\n   resample address     price bed    bath  area type  year_built heating cooling\n      <int> <chr>       <dbl> <fct> <dbl> <dbl> <chr>      <dbl> <chr>   <fct>  \n 1        1 1601 Ande… 270000 3       3    1416 Sing…       1990 No Data other  \n 2        1 1103 Ande… 525000 3       3    2256 Sing…       2016 Heat p… other  \n 3        1 2703 Sevi… 475000 3       2    2425 Sing…       1961 Forced… other  \n 4        1 2401 Perk… 550000 3       3    2109 Sing…       1953 Forced… central\n 5        1 2618 Pick… 412500 3       2    1661 Sing…       1941 Other,… other  \n 6        1 147 Pinec… 600000 3       2.5  2514 Sing…       1934 Other   other  \n 7        1 2809 Mcdo… 525000 3       2    1932 Sing…       1978 Forced… central\n 8        1 2413 Perk… 385000 3       2    1831 Sing…       1951 Forced… central\n 9        1 2813 Mont… 540000 3       3    2165 Sing…       1983 Forced… central\n10        1 2749 Dogw… 592000 3       2    2378 Sing…       1960 Forced… other  \n# ℹ 48,490 more rows\n# ℹ 4 more variables: parking <chr>, lot <dbl>, hoa <chr>, url <chr>\n```\n\n\n:::\n:::\n\n\n\n## Bootstrap samples - another look\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglimpse(duke_forest_bootstraps)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 48,500\nColumns: 14\n$ resample   <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ address    <chr> \"1601 Anderson St, Durham, NC 27707\", \"1103 Anderson St, Du…\n$ price      <dbl> 270000, 525000, 475000, 550000, 412500, 600000, 525000, 385…\n$ bed        <fct> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…\n$ bath       <dbl> 3.0, 3.0, 2.0, 3.0, 2.0, 2.5, 2.0, 2.0, 3.0, 2.0, 2.0, 3.0,…\n$ area       <dbl> 1416, 2256, 2425, 2109, 1661, 2514, 1932, 1831, 2165, 2378,…\n$ type       <chr> \"Single Family\", \"Single Family\", \"Single Family\", \"Single …\n$ year_built <dbl> 1990, 2016, 1961, 1953, 1941, 1934, 1978, 1951, 1983, 1960,…\n$ heating    <chr> \"No Data\", \"Heat pump, Gas\", \"Forced air, Gas\", \"Forced air…\n$ cooling    <fct> other, other, other, central, other, other, central, centra…\n$ parking    <chr> \"0 spaces\", \"Covered\", \"Carport, Covered\", \"Garage - Attach…\n$ lot        <dbl> 0.36, 0.24, 0.94, 0.61, 0.54, 0.69, 0.54, 0.29, 0.39, 0.75,…\n$ hoa        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ url        <chr> \"https://www.zillow.com/homedetails/1601-Anderson-St-Durham…\n```\n\n\n:::\n:::\n\n\n\n## `ae-12`: Part 1 {.smaller}\n\n::: task\nThe following visualization shows **bootstrap confidence intervals for predictions** from additive (main effects) models for predicting price from area and number of bedrooms.\nRecreate the visualization.\nOnce you're done, share your code and plot on Slack in #general.\n:::\n\n![](images/boot-ci-preds.png){fig-align=\"center\" width=\"1000\"}\n\n## `ae-12`: Part 2 {.smaller}\n\n::: task\nConstruct and visualize **bootstrap distributions of model estimates** using halfeye plots, i.e., recreate the following visualization.\nOnce you're done, share your code and plot on Slack in #general.\nThen, try other `stat`s (other ways of visualizing the distributions) from the **ggdist** package.\n:::\n\n::: {layout-ncol=\"3\"}\n![](images/boot-model-est-1.png)\n\n![](images/boot-model-est-2.png)\n\n![](images/boot-model-est-3.png)\n:::\n",
    "supporting": [
      "17-uncertainty-II_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}